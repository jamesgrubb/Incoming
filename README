This is the same code I use over at aerotwist.com/incoming. I've made it open source :)

Read the wiki to get going!